console.log('This site was generated by Hugo.');
// 检查window.config是否已经定义
if (!window.config) {
  window.config = {};
}
document.addEventListener("DOMContentLoaded", () => {
  Wap_Sidebar();
  Overflow_Close();
  initSiteTime();
});

function Overflow_Close() {
  $(".header_hyal").on("click", function () {
    $("body").css("overflow", "");
    $(".header_hyal").removeClass("active slideout");
    $(".header_roll").removeClass("active");
  });
}

function Wap_Sidebar() {
  $(".header_internal-slideicon").on("click", function () {
    $(".header_search").removeClass("active");
    if ($(".header_roll").hasClass("active")) {
      $("body").css("overflow", "");
      $(".header_hyal").removeClass("active slideout");
      $(".header_roll").removeClass("active");
    } else {
      $("body").css("overflow", "overflow");
      $(".header_hyal").addClass("active slideout");
      $(".header_roll").addClass("active");
    }
  });
}
  /**
   * date validator
   * @param {*} date may be date or not
   * @returns {Boolean}
   */
  function isValidDate(date) {
    return date instanceof Date && !isNaN(date.getTime());
  }

function setSiteTime() {
  let now = new Date();
  let run = new Date(window.config.Date);
  let $runTimes = document.getElementById("XMT_run_time");

  if (!isValidDate(run) || !$runTimes) {
    clearInterval(this.siteTime);
    $runTimes && $runTimes.parentNode.remove();
    return;
  }

  let runTime = (now - run) / 1000,
    days = Math.floor(runTime / 60 / 60 / 24),
    hours = Math.floor(runTime / 60 / 60 - 24 * days),
    minutes = Math.floor(runTime / 60 - 24 * 60 * days - 60 * hours),
    seconds = Math.floor((now - run) / 1000 - 24 * 60 * 60 * days - 60 * 60 * hours - 60 * minutes);
    $runTimes.innerHTML = `${days}, ${String(hours).padStart(2, 0)}:${String(minutes).padStart(2, 0)}:${String(seconds).padStart(2, 0)}`;

};

function initSiteTime() {

  if (window.config.Date) {
    this.siteTime = setInterval(setSiteTime, 500);
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        return clearInterval(this.siteTime);
      }
      this.siteTime = setInterval(setSiteTime, 500);
    }, false);
  }
};

